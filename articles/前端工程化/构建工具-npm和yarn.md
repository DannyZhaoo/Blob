# npm和yarn
在现在的前端开发中，想完全避开npm和yarn是没有可能的。npm作为node的包管理器，对node乃至前端的繁荣，起到了至关重要的作用。

但是，虽然经常使用，但是我很少去查看其内部的原理，也听说过yarn要比npm快速和好用，但是也不知道具体原因。

今天写这个部分，就是梳理一下这方面的内容。

## package.json
npm主要作为包管理器，那么定义一个模块最重要的内容，肯定就是package.json了。

在package.json中**常用**与**易混淆**的字段：


## npm依赖包管理原理
- 现状： 
  
  **扁平结构**

  安装模块时，不管其是直接依赖还是子依赖的依赖，优先将其安装在 node_modules 根目录。

  当安装到**相同模块**时，判断已安装的模块版本是否符合**新模块的版本范围**，如果符合则跳过，不符合则在当前模块的 node_modules 下安装该模块。

  ---

  - 问题：那么这样node_modules的结构就会因为不同插件安装的时间和顺序，导致安装顺序不一样。
  
    **lock文件**
    为了解决上述问题，就出现了 `package-lock.json` 文件。`package-lock.json` 的作用是锁定依赖结构。即只要你目录下有 package-lock.json 文件，那么你每次执行 npm install 后生成的 node_modules 目录结构一定是完全相同的


- 历史：

  **嵌套结构**

  在 `npm` 的早期版本， npm 处理依赖的方式简单粗暴，以递归的形式，严格按照 package.json 结构以及子依赖包的 package.json 结构将依赖安装到他们各自的 node_modules 中。直到有子依赖包不在依赖其他模块。

  问题:
  1. 在不同层级的依赖中，可能引用了同一个模块，导致大量冗余。
  2. 在`Windows`系统中，文件路径最大长度为260个字符，嵌套层级过深可能导致不可预知的问题


## npm与yarn的关系

在早起npm确实由于**嵌套结构**存在很大问题，所以出现yarn提出了**扁平化和lock文件**。

而后期npm的改造，也大多数采取yarn的设计理念，所以现在**使用方面的差异**倒是不太大。


## npm与npm远程仓库

**缓存**



